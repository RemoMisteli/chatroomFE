<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="stylesheet" href="styles.css">
    <title>ChatRoom</title>
</head>

<body>
    <div class="element title">
        <h1>ChatRoom</h1>
        <p>Here you can chat with your friends</p>
    </div>


    <div class="chatMessages element" id="chatMessages">
        <div id="messages"></div>


        Remo: hey <br>
        Fred: hey, how are you?<br>
        Remo: I am fine you?<br>
    </div>


    <div class="element">

        Name:<input class="usernNameField" id="usernameField" placeholder="your name">
        Message:<input class="messageField" id="messageField" placeholder="your message">
        <button class="sendButton" onclick="send()">send</button>
    </div>


    <script>window.onload = function () {
            getMessage();
        };
        window.setInterval(function () {
            getMessage();
        }, 5000);
    </script>

    <script>
        var xmlhttp = new XMLHttpRequest();
        var url = "http://localhost:8080/chatroom/messages/";

        function getMessage() {
            xmlhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    document.getElementById("messages").innerHTML = this.responseText;
                }
            };
            xmlhttp.open("GET", url, true);
            xmlhttp.send();
        }

    </script>

    <script>
        function send() {
            var sendUrl = url + "send/";
            var name = document.getElementById('usernameField').value;
            var message = document.getElementById('messageField').value;
            if (name != '' && message != '') {
                document.getElementById('usernameField').value = "";
                document.getElementById('messageField').value = "";

                sendUrl = sendUrl + name + "/";
                sendUrl = sendUrl + message;

                xmlhttp.open("GET", sendUrl, true);
                xmlhttp.send();

                getMessage();
            }



        }
    </script>
</body>

</html>